@page "/teachers"
@using BlazorAcademy.Data
@using BlazorAcademy.Models
@using Microsoft.EntityFrameworkCore
@inject BlazorAcademyContext Context

<h3>Teachers</h3>

<button @onclick="AddTestTeacher" class="btn btn-primary">Add Test Teacher</button>

@if (teachers.Any())
{
    @foreach (var teacher in teachers)
    {
        <div class="card mt-2">
            <div class="card-body">
                <h5>@teacher.first_name @teacher.last_name</h5>
                <p>Experience: @teacher.Experience years</p>
                <p>Age: @teacher.Age years</p>
            </div>
        </div>
    }
}
else
{
    <p>No teachers found. Click the button to add one.</p>
}

@code {
    private List<TeacherSimple> teachers = new();

    protected override async Task OnInitializedAsync()
    {
        teachers = await Context.TeacherSimples.ToListAsync();
    }

    private async Task AddTestTeacher()
    {
        var newTeacher = new TeacherSimple
            {
                first_name = "John",
                last_name = "Doe",
                birth_date = new DateOnly(1980, 1, 1),
                work_since = new DateOnly(2010, 1, 1),
                rate = 1000.50m
            };

        Context.TeacherSimples.Add(newTeacher);
        await Context.SaveChangesAsync();

        teachers = await Context.TeacherSimples.ToListAsync();
    }
}